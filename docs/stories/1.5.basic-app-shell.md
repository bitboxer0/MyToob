# Story 1.5: Basic App Shell & Navigation

## Status
Draft

## Story
**As a** user,
**I want** a minimal but functional macOS app window with sidebar and main content area,
**so that** I have a foundation UI to build features upon.

## Acceptance Criteria
1. SwiftUI `App` struct created with `@main` entry point
2. Main window created with `WindowGroup` and minimum size (1024x768)
3. Sidebar + content split view layout implemented
4. Sidebar shows placeholder sections: "Collections", "YouTube", "Local Files"
5. Main content area shows placeholder message: "Select an item from the sidebar"
6. App launches without crashes and displays window correctly
7. Window state (size, position) persists across app launches (using AppStorage or SceneStorage)

## Tasks / Subtasks
- [ ] Create app entry point (AC: 1)
  - [ ] Create `MyToob/MyToobApp.swift` file
  - [ ] Add `@main` attribute to App struct
  - [ ] Configure WindowGroup with ContentView
  - [ ] Inject ModelContainer into environment (from Story 1.4)
- [ ] Create main window configuration (AC: 2)
  - [ ] Set window title to "MyToob"
  - [ ] Configure minimum window size (1024x768)
  - [ ] Set default window size
  - [ ] Add window toolbar if needed
- [ ] Create root ContentView (AC: 3)
  - [ ] Create `MyToob/App/ContentView.swift` file
  - [ ] Implement NavigationSplitView for sidebar + content layout
  - [ ] Configure sidebar width constraints
  - [ ] Set up navigation state management
- [ ] Implement sidebar (AC: 4)
  - [ ] Create sidebar list with sections
  - [ ] Add "Collections" section with icon
  - [ ] Add "YouTube" section with icon
  - [ ] Add "Local Files" section with icon
  - [ ] Style sidebar items with SF Symbols icons
  - [ ] Implement selection state for sidebar items
- [ ] Implement main content area (AC: 5)
  - [ ] Create placeholder view for empty state
  - [ ] Show "Select an item from the sidebar" message
  - [ ] Add appropriate icon for empty state
  - [ ] Style content area appropriately
- [ ] Verify app launch (AC: 6)
  - [ ] Build and run app
  - [ ] Verify window appears correctly
  - [ ] Verify sidebar displays properly
  - [ ] Verify content area shows placeholder
  - [ ] Test sidebar selection interaction
  - [ ] Check for console errors or warnings
- [ ] Implement window state persistence (AC: 7)
  - [ ] Use AppStorage or SceneStorage for window size
  - [ ] Use AppStorage or SceneStorage for window position
  - [ ] Test window state persists after app quit/relaunch
  - [ ] Verify window state works correctly across displays

## Dev Notes

### Project Structure for Views
[Source: architecture/unified-project-structure.md]
```
MyToob/
├── MyToobApp.swift         # @main app entry point
├── App/
│   ├── ContentView.swift   # Root view with NavigationSplitView
│   └── MainWindowView.swift # (optional, could be combined with ContentView)
```

### SwiftUI and Tech Stack
[Source: architecture/tech-stack.md]
- **UI Framework:** SwiftUI (macOS 14+)
- **Rationale:** Apple's recommended framework, reactive, excellent performance, native look-and-feel
- **Navigation:** NavigationSplitView for sidebar + content layout

### App Entry Point Pattern
The app entry point should configure:
1. ModelContainer (from Story 1.4)
2. WindowGroup with ContentView
3. Window configuration (title, size)
4. Environment setup

Example structure:
```swift
@main
struct MyToobApp: App {
    let modelContainer: ModelContainer

    init() {
        // Initialize ModelContainer (from Story 1.4)
    }

    var body: some Scene {
        WindowGroup {
            ContentView()
        }
        .modelContainer(modelContainer)
        .defaultSize(width: 1024, height: 768)
    }
}
```

### Navigation Split View Layout
[Source: architecture/high-level-architecture.md]
The app uses a classic macOS sidebar + content layout:
- Sidebar: Navigation menu with collections, sources
- Content: Main viewing area (library, player, search results)

Implementation using NavigationSplitView:
```swift
struct ContentView: View {
    @State private var selectedSection: SidebarSection? = nil

    var body: some View {
        NavigationSplitView {
            // Sidebar
            List(selection: $selectedSection) {
                Section("Library") {
                    Label("Collections", systemImage: "folder")
                        .tag(SidebarSection.collections)
                }
                Section("Sources") {
                    Label("YouTube", systemImage: "play.rectangle")
                        .tag(SidebarSection.youtube)
                    Label("Local Files", systemImage: "doc")
                        .tag(SidebarSection.localFiles)
                }
            }
            .navigationTitle("MyToob")
        } detail: {
            // Main content area
            if selectedSection == nil {
                PlaceholderView()
            } else {
                // Future: Route to appropriate view based on selection
                Text("Coming soon")
            }
        }
    }
}

enum SidebarSection: Hashable {
    case collections
    case youtube
    case localFiles
}
```

### Window State Persistence
Use AppStorage for simple window preferences:
```swift
@AppStorage("windowWidth") private var windowWidth: Double = 1024
@AppStorage("windowHeight") private var windowHeight: Double = 768
```

Or use SceneStorage for per-window state in multi-window scenarios.

### SF Symbols Icons
Use appropriate SF Symbols for sidebar items:
- Collections: `folder`, `folder.fill`, or `square.grid.2x2`
- YouTube: `play.rectangle`, `play.rectangle.fill`
- Local Files: `doc`, `doc.fill`, `video`

## Testing

### Testing Standards
[Source: architecture/testing-strategy.md]
- **UI Tests:** MyToobUITests/ directory
- **Framework:** XCUITest
- **Coverage Target:** 5% E2E tests

### Testing Requirements for This Story
**Manual Testing:**
- App launches successfully
- Window appears at correct size
- Sidebar displays correctly
- Content area shows placeholder
- Sidebar selection changes work
- Window state persists after relaunch

**Automated UI Tests:**
- Create `MyToobUITests/AppLaunchTests.swift`
- Test: App launches without crash
- Test: Window appears
- Test: Sidebar is visible
- Test: Sidebar items are accessible

**Example UI Test:**
```swift
@Test("App launches and displays main window")
func testAppLaunch() async throws {
    let app = XCUIApplication()
    app.launch()

    // Verify window exists
    let window = app.windows.firstMatch
    #expect(window.exists)

    // Verify sidebar exists
    let sidebar = app.splitGroups.firstMatch
    #expect(sidebar.exists)

    // Verify sidebar items
    let collectionsItem = app.staticTexts["Collections"]
    #expect(collectionsItem.exists)

    let youtubeItem = app.staticTexts["YouTube"]
    #expect(youtubeItem.exists)

    let localFilesItem = app.staticTexts["Local Files"]
    #expect(localFilesItem.exists)
}
```

### Accessibility Testing
- All sidebar items should be accessible via VoiceOver
- Proper accessibility labels for icons
- Keyboard navigation should work (Tab, arrow keys)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-11-17 | 1.0 | Initial story creation | Scrum Master (Bob) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes List
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_
